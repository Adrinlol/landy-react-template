"use strict";var e=require("autoprefixer"),s=require("browserslist"),t=require("cssdb"),o=require("postcss-attribute-case-insensitive"),r=require("css-blank-pseudo"),i=require("postcss-color-functional-notation"),n=require("postcss-color-hex-alpha"),c=require("postcss-color-rebeccapurple"),u=require("postcss-custom-media"),a=require("postcss-custom-properties"),p=require("postcss-custom-selectors"),l=require("postcss-dir-pseudo-class"),f=require("postcss-double-position-gradients"),d=require("postcss-env-function"),m=require("postcss-focus-visible"),b=require("postcss-focus-within"),g=require("postcss-font-variant"),y=require("postcss-gap-properties"),v=require("css-has-pseudo"),O=require("postcss-image-set-function"),h=require("postcss-initial"),w=require("postcss-lab-function"),j=require("postcss-logical"),$=require("postcss-media-minmax"),q=require("postcss-nesting"),k=require("postcss-overflow-shorthand"),x=require("postcss-page-break"),S=require("postcss-place"),P=require("css-prefers-color-scheme"),M=require("postcss-pseudo-class-any-link"),F=require("postcss-replace-overflow-wrap"),T=require("postcss-selector-not"),B=require("caniuse-lite"),U=require("fs"),A=require("path");function V(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function E(e){if(e&&e.__esModule)return e;var s=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var o=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(s,t,o.get?o:{enumerable:!0,get:function(){return e[t]}})}})),s.default=e,Object.freeze(s)}var I=V(e),N=V(s),C=V(t),D=V(o),J=V(r),R=V(i),_=V(n),z=V(c),L=V(u),G=V(a),H=V(p),K=V(l),Q=V(f),W=V(d),X=V(m),Y=V(b),Z=V(g),ee=V(y),se=V(v),te=V(O),oe=V(h),re=V(w),ie=V(j),ne=V($),ce=V(q),ue=V(k),ae=V(x),pe=V(S),le=V(P),fe=V(M),de=V(F),me=V(T),be=E(B),ge=V(U),ye=V(A);function ve(){return{postcssPlugin:"postcss-system-ui-font",Declaration(e){Oe.test(e.prop)&&(e.value.includes(we.join(", "))||(e.value=e.value.replace(je,$e)))}}}ve.postcss=!0;const Oe=/(?:^(?:-|\\002d){2})|(?:^font(?:-family)?$)/i,he="[\\f\\n\\r\\x09\\x20]",we=["system-ui","-apple-system","Segoe UI","Roboto","Ubuntu","Cantarell","Noto Sans","sans-serif"],je=new RegExp(`(^|,|${he}+)(?:system-ui${he}*)(?:,${he}*(?:${we.join("|")})${he}*)?(,|$)`,"i"),$e=`$1${we.join(", ")}$2`,qe={"css-blank-pseudo":"blank-pseudo-class","css-has-pseudo":"has-pseudo-class","css-prefers-color-scheme":"prefers-color-scheme-query","postcss-attribute-case-insensitive":"case-insensitive-attributes","postcss-color-functional-notation":"color-functional-notation","postcss-color-hex-alpha":"hexadecimal-alpha-notation","postcss-color-rebeccapurple":"rebeccapurple-color","postcss-custom-media":"custom-media-queries","postcss-custom-properties":"custom-properties","postcss-custom-selectors":"custom-selectors","postcss-dir-pseudo-class":"dir-pseudo-class","postcss-double-position-gradients":"double-position-gradients","postcss-env-function":"environment-variables","postcss-focus-visible":"focus-visible-pseudo-class","postcss-focus-within":"focus-within-pseudo-class","postcss-font-variant":"font-variant-property","postcss-gap-properties":"gap-properties","postcss-image-set-function":"image-set-function","postcss-initial":"all-property","postcss-lab-function":"lab-function","postcss-logical":"logical-properties-and-values","postcss-media-minmax":"media-query-ranges","postcss-nesting":"nesting-rules","postcss-overflow-shorthand":"overflow-property","postcss-page-break":"break-properties","postcss-place":"place-properties","postcss-pseudo-class-any-link":"any-link-pseudo-class","postcss-replace-overflow-wrap":"overflow-wrap-property","postcss-selector-not":"not-pseudo-class","postcss-system-ui-font-family":"system-ui-font-family"},ke=(()=>{const e={};for(const[s,t]of Object.entries(qe))e[t]=s;return e})(),xe={"all-property":oe.default,"any-link-pseudo-class":fe.default,"blank-pseudo-class":J.default,"break-properties":ae.default,"case-insensitive-attributes":D.default,"color-functional-notation":R.default,"custom-media-queries":L.default,"custom-properties":G.default,"custom-selectors":H.default,"dir-pseudo-class":K.default,"double-position-gradients":Q.default,"environment-variables":W.default,"focus-visible-pseudo-class":X.default,"focus-within-pseudo-class":Y.default,"font-variant-property":Z.default,"gap-properties":ee.default,"has-pseudo-class":se.default,"hexadecimal-alpha-notation":_.default,"image-set-function":te.default,"lab-function":re.default,"logical-properties-and-values":ie.default,"media-query-ranges":ne.default,"nesting-rules":ce.default,"not-pseudo-class":me.default,"overflow-property":ue.default,"overflow-wrap-property":de.default,"place-properties":pe.default,"prefers-color-scheme-query":le.default,"rebeccapurple-color":z.default,"system-ui-font-family":ve};function Se(e,s){return Object.keys(e).map((t=>[].concat(e[t]).map((e=>({[s]:!0,plugin:e,id:t}))))).reduce(((e,s)=>e.concat(s)),[])}function Pe(e){const s=be.features[e];if(s){const e=be.feature(s).stats;return Object.keys(e).reduce(((s,t)=>s.concat(Object.keys(e[t]).filter((s=>0!==e[t][s].indexOf("y"))).map((e=>`${t} ${e}`)))),[])}return["> 0%"]}var Me=["custom-media-queries","custom-properties","environment-variables","image-set-function","media-query-ranges","prefers-color-scheme-query","nesting-rules","custom-selectors","any-link-pseudo-class","case-insensitive-attributes","focus-visible-pseudo-class","focus-within-pseudo-class","matches-pseudo-class","not-pseudo-class","logical-properties-and-values","dir-pseudo-class","all-property","color-functional-notation","double-position-gradients","hexadecimal-alpha-notation","lab-function","rebeccapurple-color","color-mod-function","blank-pseudo-class","break-properties","font-variant-property","has-pseudo-class","gap-properties","overflow-property","overflow-wrap-property","place-properties","system-ui-font-family"];async function Fe(e,s,t,o){const r=function(e){return`:root {\n${Object.keys(e).reduce(((s,t)=>(s.push(`\t${t}: ${e[t]};`),s)),[]).join("\n")}\n}\n`}(t),i=function(e){return`${Object.keys(e).reduce(((s,t)=>(s.push(`@custom-media ${t} ${e[t]};`),s)),[]).join("\n")}\n`}(s),n=function(e){return`${Object.keys(e).reduce(((s,t)=>(s.push(`@custom-selector ${t} ${e[t]};`),s)),[]).join("\n")}\n`}(o),c=`${i}\n${n}\n${r}`;await Ve(e,c)}function Te(e,s){return`\n\t${e}: {\n${Object.keys(s).reduce(((e,t)=>(e.push(`\t\t'${Ee(t)}': '${Ee(s[t])}'`),e)),[]).join(",\n")}\n\t}`}function Be(e,s){return`export const ${e} = {\n${Object.keys(s).reduce(((e,t)=>(e.push(`\t'${Ee(t)}': '${Ee(s[t])}'`),e)),[]).join(",\n")}\n};\n`}function Ue(e,s){return Promise.all([].concat(s).map((async s=>{if(s instanceof Function)await s({customMedia:Ae(e.customMedia),customProperties:Ae(e.customProperties),customSelectors:Ae(e.customSelectors)});else{const t=s===Object(s)?s:{to:String(s)},o=t.toJSON||Ae;if("customMedia"in t||"customProperties"in t||"customSelectors"in t)t.customMedia=o(e.customMedia),t.customProperties=o(e.customProperties),t.customSelectors=o(e.customSelectors);else if("custom-media"in t||"custom-properties"in t||"custom-selectors"in t)t["custom-media"]=o(e.customMedia),t["custom-properties"]=o(e.customProperties),t["custom-selectors"]=o(e.customSelectors);else{const s=String(t.to||""),r=(t.type||ye.default.extname(t.to).slice(1)).toLowerCase(),i=o(e.customMedia),n=o(e.customProperties),c=o(e.customSelectors);"css"===r&&await Fe(s,i,n,c),"js"===r&&await async function(e,s,t,o){const r=`module.exports = {${Te("customMedia",s)},${Te("customProperties",t)},${Te("customSelectors",o)}\n};\n`;await Ve(e,r)}(s,i,n,c),"json"===r&&await async function(e,s,t,o){const r=`${JSON.stringify({"custom-media":s,"custom-properties":t,"custom-selectors":o},null,"  ")}\n`;await Ve(e,r)}(s,i,n,c),"mjs"===r&&await async function(e,s,t,o){const r=`${Be("customMedia",s)}\n${Be("customProperties",t)}\n${Be("customSelectors",o)}`;await Ve(e,r)}(s,i,n,c)}}})))}function Ae(e){return Object.keys(e).reduce(((s,t)=>(s[t]=String(e[t]),s)),{})}function Ve(e,s){return new Promise(((t,o)=>{ge.default.writeFile(e,s,(e=>{e?o(e):t()}))}))}function Ee(e){return e.replace(/\\([\s\S])|(')/g,"\\$1$2").replace(/\n/g,"\\n").replace(/\r/g,"\\r")}function Ie(e,s){const t=N.default(e,{ignoreUnknownVersions:!0});return"nesting-rules"===s.id&&function(e,s){const t=Pe(e);if(s.some((e=>N.default(t,{ignoreUnknownVersions:!0}).some((s=>s===e)))))return!0;return!1}("css-matches-pseudo",t)?{noIsPseudoSelector:!0}:{}}function Ne(e,s){let t="unknown",o=1/0;for(let r=0;r<s.length;r++){const i=Ce(e,s[r]);i<o&&(o=i,t=s[r])}return{mostSimilar:t,distance:o}}function Ce(e,s){if(!e.length)return s.length;if(!s.length)return e.length;const t=[];for(let o=0;o<=s.length;o++){t[o]=[o];for(let r=1;r<=e.length;r++)t[o][r]=0===o?r:Math.min(t[o-1][r]+1,t[o][r-1]+1,t[o-1][r-1]+(e[r-1]===s[o-1]?0:1))}return t[s.length][e.length]}function De(e,s){if(!e)return!1;if("string"==typeof e)return!0;if(Array.isArray(e)){for(let t=0;t<e.length;t++){if("string"==typeof e[t])return!0;if(e[t]&&s in Object(e[t]))return!0}return!1}return s in Object(e)}const Je=e=>{const s=Object(Object(e).features),t=Object.keys(s),o=Object(Object(e).insertBefore),r=Object(Object(e).insertAfter),i=Object(e).browsers,n="stage"in Object(e)?!1===e.stage?5:parseInt(e.stage)||0:2,c=Object(e).autoprefixer,u=Re(Object(e)),a=!1===c?()=>{}:I.default(Object.assign({overrideBrowserslist:i},c)),p=C.default.concat(Se(o,"insertBefore"),Se(r,"insertAfter")).filter((e=>e.insertBefore||e.id in xe)).sort(((e,s)=>Me.indexOf(e.id)-Me.indexOf(s.id)||(e.insertBefore?-1:s.insertBefore?1:0)||(e.insertAfter?1:s.insertAfter?-1:0))).map((e=>{const s=Pe(e.caniuse);return e.insertBefore||e.insertAfter?{browsers:s,plugin:e.plugin,id:`${e.insertBefore?"before":"after"}-${e.id}`,stage:6}:{browsers:s,plugin:xe[e.id],id:e.id,stage:e.stage}})).filter((e=>e.id in s?s[e.id]:e.stage>=n)).map((e=>{let t,o;return t=Ie(i,e),t=!0===s[e.id]?u?Object.assign({},t,u):void 0:u?Object.assign({},t,u,s[e.id]):Object.assign({},t,s[e.id]),o=e.plugin.postcss?e.plugin(t):e.plugin,{browsers:e.browsers,plugin:o,pluginOptions:t,id:e.id}})),l=N.default(i,{ignoreUnknownVersions:!0}),f=p.filter((e=>e.id in s?s[e.id]:!!function(e){if("importFrom"in Object(e.pluginOptions))switch(e.id){case"custom-media-queries":if(De(e.pluginOptions.importFrom,"customMedia"))return!0;break;case"custom-properties":if(De(e.pluginOptions.importFrom,"customProperties"))return!0;break;case"environment-variables":if(De(e.pluginOptions.importFrom,"environmentVariables"))return!0;break;case"custom-selectors":if(De(e.pluginOptions.importFrom,"customSelectors"))return!0}if("exportTo"in Object(e.pluginOptions))switch(e.id){case"custom-media-queries":if(De(e.pluginOptions.exportTo,"customMedia"))return!0;break;case"custom-properties":if(De(e.pluginOptions.exportTo,"customProperties"))return!0;break;case"environment-variables":if(De(e.pluginOptions.exportTo,"environmentVariables"))return!0;break;case"custom-selectors":if(De(e.pluginOptions.exportTo,"customSelectors"))return!0}return!1}(e)||l.some((s=>N.default(e.browsers,{ignoreUnknownVersions:!0}).some((e=>e===s)))))).map((e=>e.plugin));f.push(a);const d=()=>({postcssPlugin:"postcss-preset-env",OnceExit:function(s,{result:o}){!function(e,s,t){const o=Object.keys(ke),r=Object.keys(qe);e.forEach((e=>{if(o.includes(e))return;const i=Ne(e,o),n=Ne(e,r);i.distance<n.distance?s.warn(t,`Unknown feature: "${e}" did you mean: "${i.mostSimilar}"`):s.warn(t,`Unknown feature: "${e}" did you mean: "${qe[n.mostSimilar]}"`)}))}(t,s,o),Object(e).exportTo&&Ue(u.exportTo,e.exportTo)}});return d.postcss=!0,{postcssPlugin:"postcss-preset-env",plugins:[...f,d()]}},Re=e=>{if("importFrom"in e||"exportTo"in e||"preserve"in e){const s={};return"importFrom"in e&&(s.importFrom=e.importFrom),"exportTo"in e&&(s.exportTo={customMedia:{},customProperties:{},customSelectors:{}}),"preserve"in e&&(s.preserve=e.preserve),s}return!1};Je.postcss=!0,module.exports=Je;
